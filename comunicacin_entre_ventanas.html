<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="exe_highlighter.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Comunicación entre ventanas | JavaFX </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="es" />
<meta name="author" content="José Ramón Jiménez Reyes" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="exe_highlighter.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" /></head>
<body class="exe-web-site" id="exe-node-48"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<div id="header" ><div id="headerContent">JavaFX</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">JavaFX</a></li>
   <li><a href="diseo_de_interfaces.html" class="daddy">Diseño de interfaces</a>
   <ul class="other-section">
      <li><a href="controles.html" class="daddy">Controles</a>
      <ul class="other-section">
         <li><a href="etiquetas.html" class="no-ch">Etiquetas</a></li>
         <li><a href="hiperenlaces.html" class="no-ch">Hiperenlaces</a></li>
         <li><a href="campos_de_texto.html" class="no-ch">Campos de texto</a></li>
         <li><a href="campos_de_contrasea.html" class="no-ch">Campos de contraseña</a></li>
         <li><a href="botones.html" class="no-ch">Botones</a></li>
         <li><a href="botones_de_activacin.html" class="no-ch">Botones de activación</a></li>
         <li><a href="radio_botones.html" class="no-ch">Radio botones</a></li>
         <li><a href="casillas_de_verificacin.html" class="no-ch">Casillas de verificación</a></li>
         <li><a href="cajas_de_eleccin.html" class="no-ch">Cajas de elección</a></li>
         <li><a href="cajas_combinadas.html" class="no-ch">Cajas combinadas</a></li>
         <li><a href="separador.html" class="no-ch">Separador</a></li>
         <li><a href="barras_de_desplazamiento_y_paneles_de_desplazamiento.html" class="no-ch">Barras de desplazamiento y paneles de desplazamiento</a></li>
         <li><a href="deslizador.html" class="no-ch">Deslizador</a></li>
         <li><a href="barras_e_indicadores_de_progreso.html" class="no-ch">Barras e indicadores de progreso</a></li>
         <li><a href="vista_de_lista.html" class="no-ch">Vista de lista</a></li>
         <li><a href="vista_de_tabla.html" class="no-ch">Vista de tabla</a></li>
         <li><a href="vista_de_rbol.html" class="no-ch">Vista de árbol</a></li>
         <li><a href="vista_de_tabla_en_rbol.html" class="no-ch">Vista de tabla en árbol</a></li>
         <li><a href="editor_html.html" class="no-ch">Editor HTML</a></li>
         <li><a href="informacin_contextual.html" class="no-ch">Información contextual</a></li>
         <li><a href="mens.html" class="no-ch">Menús</a></li>
         <li><a href="paneles_con_ttulo_y_acordeones.html" class="no-ch">Paneles con título y acordeones</a></li>
         <li><a href="paginacin.html" class="no-ch">Paginación</a></li>
         <li><a href="selector_de_color.html" class="no-ch">Selector de color</a></li>
         <li><a href="selector_de_fecha.html" class="no-ch">Selector de fecha</a></li>
         <li><a href="selector_de_ficheros.html" class="no-ch">Selector de ficheros</a></li>
      </ul>
      </li>
      <li><a href="paneles_de_diseo.html" class="no-ch">Paneles de diseño</a></li>
      <li><a href="personalizacin_de_interfaces.html" class="no-ch">Personalización de interfaces</a></li>
   </ul>
   </li>
   <li><a href="interaccionando_con_el_usuario.html" class="daddy">Interaccionando con el usuario</a>
   <ul class="other-section">
      <li><a href="contador_de_pulsaciones.html" class="no-ch">Contador de pulsaciones</a></li>
      <li><a href="qu_botn_hemos_pulsado.html" class="no-ch">¿Qué botón hemos pulsado?</a></li>
      <li><a href="campo_de_texto_con_una_longitud_mxima.html" class="no-ch">Campo de texto con una longitud máxima</a></li>
      <li><a href="campo_de_texto_numrico.html" class="no-ch">Campo de texto numérico</a></li>
      <li><a href="qu_radio_botn_hemos_seleccionado.html" class="no-ch">¿Qué radio botón hemos seleccionado?</a></li>
      <li><a href="qu_opcin_hemos_escojido_de_una_caja_de_eleccin.html" class="no-ch">¿Qué opción hemos escojido de una caja de elección?</a></li>
      <li><a href="elige_las_imgenes_a_mostrar.html" class="no-ch">Elige las imágenes a mostrar</a></li>
      <li><a href="posicin_del_ratn.html" class="no-ch">Posición del ratón</a></li>
      <li><a href="cmo_cambia_el_valor_de_un_deslizador.html" class="no-ch">¿Cómo cambia el valor de un deslizador?</a></li>
      <li><a href="interaccionando_con_una_lista.html" class="no-ch">Interaccionando con una lista</a></li>
      <li><a href="mostrando_dilogos.html" class="no-ch">Mostrando diálogos</a></li>
      <li><a href="trabajando_con_tablas.html" class="no-ch">Trabajando con tablas</a></li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="fxml.html" class="current-page-parent daddy">FXML</a>
   <ul>
      <li><a href="scenebuilder.html" class="no-ch">SceneBuilder</a></li>
      <li id="active"><a href="comunicacin_entre_ventanas.html" class="active no-ch">Comunicación entre ventanas</a></li>
   </ul>
   </li>
   <li><a href="cdigo_de_los_ejemplos.html" class="no-ch">Código de los ejemplos</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="scenebuilder.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="cdigo_de_los_ejemplos.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">Comunicación entre ventanas</h1></div>
<div class="iDevice_wrapper textIdevice" id="id47">
<div class="iDevice emphasis0" >
<div id="ta47_108_2" class="block iDevice_content">
<div class="exe-text"><p>Si queremos comunicar ventanas o, mejor dicho, escenas, debemos tener un mecanismo para poder tener un flujo de información entre controladores. La forma que hemos visto en el ejemplo anterior no nos vale para este menester ya que en el fichero <code>.fxml</code>, o en el SceneBuilder, indicamos cuál es el controlador y en el proceso de carga se crea dicho controlador y nosotros no tenemos acceso al mismo. Lo hacíamos con el siguiente código:</p>
<div class="highlighted-code code-style-2 language-java">
<div>
<pre><code>Parent raiz = FXMLLoader.load(LocalizadorRecursos.class.getResource("vistas/Ejemplo.fxml"));</code></pre>
</div>
</div>
<p>Sin embargo, podemos obtener el mismo efecto creando una clase cargadora para el fichero <code><strong>.fxml</strong></code>, cargando y obteniendo su controlador y así podremos tener acceso a dicho controlador.</p>
<div class="highlighted-code code-style-2 language-java">
<div>
<pre><code>FXMLLoader cargadorEjemplo = new FXMLLoader(LocalizadorRecursos.class.getResource("vistas/Ejemplo.fxml"));
Parent raiz = cargadorEjemplo.load();
cEjemplo = cargadorEjemplo.getController();</code></pre>
</div>
</div>
<p>Ahora, ya podemos tener acceso al controlador y en el mismo podemos crear métodos y propiedades para realizar dicho flujo de información.</p>
<p>Por ejemplo, en los ejemplos con todo el código he creado un paquete denominado <code><strong>javafx.comunicacionventanas</strong></code>. En él he creado un ejemplo que consta de una ventana principal desde la que puedo lanzar otras dos ventanas idénticas (Ventana1 y Ventana2) mediante dos botones en esta ventana principal. La ventana principal también tiene una etiqueta que nos informa de las acciones realizadas en cada una de las ventas (pulsar el botón de saludo o elegir una opción de una caja de elección).</p>
<p><img src="Captura_de_pantalla_de_2021-04-26_19-20-19.png" alt="" style="display: block; margin-left: auto; margin-right: auto;" width="920" height="285" /></p>
<p>El código de los controladores es el que se muestra a continuación, aunque como he dicho, lo tenéis en el código con todos los ejemplos. Para que se puedan comunicar lo que he hecho es que he pasado la etiqueta de la ventana principal a la ventana 1 y 2 para que puedan cambiar su texto.</p>
<h3 style="text-align: center;">ControladorVentanaPrincipal.java</h3>
<div class="highlighted-code code-style-2 language-java">
<div>
<pre><code>package javafx.comunicacionventanas.controladores;

import java.io.IOException;

import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.recursos.LocalizadorRecursos;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.layout.VBox;
import javafx.stage.Modality;
import javafx.stage.Stage;

public class ControladorVentanaPrincipal {
	
	@FXML private Button btVentana1;
	@FXML private Button btVentana2;
	@FXML private Label lbMensajes;
	
	private Stage escenarioVentana1;
	private Stage escenarioVentana2;

	private void crearVentana1() throws IOException {
		if (escenarioVentana1 == null) {
			escenarioVentana1 = new Stage();
			FXMLLoader cargadorVentana1 = new FXMLLoader(LocalizadorRecursos.class.getResource("vistas/Ventana1.fxml"));
			VBox raizVentana1 = cargadorVentana1.load();
			ControladorVentana1 controladorVentana1 = cargadorVentana1.getController();
			controladorVentana1.setLBMensajes(lbMensajes);
			Scene ventana1 = new Scene(raizVentana1);
			escenarioVentana1.setTitle("Ventana 1");
			escenarioVentana1.initModality(Modality.APPLICATION_MODAL); 
			escenarioVentana1.setScene(ventana1);
		}
	}
	
	private void crearVentana2() throws IOException {
		if (escenarioVentana2 == null) {
			escenarioVentana2 = new Stage();		
			FXMLLoader cargadorVentana2 = new FXMLLoader(LocalizadorRecursos.class.getResource("vistas/Ventana2.fxml"));
			VBox raizVentana2 = cargadorVentana2.load();
			ControladorVentana2 controladorVentana2 = cargadorVentana2.getController();
			controladorVentana2.setLBMensajes(lbMensajes);	
			Scene ventana2 = new Scene(raizVentana2);
			escenarioVentana2.setTitle("Ventana 2");
			escenarioVentana2.initModality(Modality.APPLICATION_MODAL);
			escenarioVentana2.setScene(ventana2);
		}
	}
	
	@FXML
	private void abrirVentana1() throws IOException {
		crearVentana1();
		escenarioVentana1.showAndWait();
	}
	
	@FXML
	private void abrirVentana2() throws IOException {
		crearVentana2();
		escenarioVentana2.showAndWait();
	}
	
}</code></pre>
</div>
</div>
<h3 style="text-align: center;">ControladorVentana1.java</h3>
<div class="highlighted-code code-style-2 language-java">
<div>
<pre><code>package javafx.comunicacionventanas.controladores;

import javafx.collections.FXCollections;
import javafx.fxml.FXML;
import javafx.scene.control.Button;
import javafx.scene.control.ComboBox;
import javafx.scene.control.Label;

public class ControladorVentana1 {
	
	@FXML private Button btSaluda;
	@FXML private ComboBox&lt;String&gt; cbAcciones;
	
	private Label lbMensajes;
	
	public void setLBMensajes(Label lbMensajes) {
		this.lbMensajes = lbMensajes;
	}
	
	@FXML 
	private void initialize() {
		cbAcciones.setItems(FXCollections.observableArrayList("Accion 1 Ventana 1", "Accion 2 Ventana 1"));
	}
	
	@FXML
	private void saluda() {
		lbMensajes.setText("Hola desde la ventana 1");
	}
	
	@FXML
	private void muestraEleccion() {
		lbMensajes.setText("Has elegido " + cbAcciones.getSelectionModel().getSelectedItem());
	}
}</code></pre>
</div>
</div>
<h3 style="text-align: center;">ControladorVentana2.java</h3>
<div class="highlighted-code code-style-2 language-java">
<div>
<pre><code>package javafx.comunicacionventanas.controladores;

import javafx.collections.FXCollections;
import javafx.fxml.FXML;
import javafx.scene.control.Button;
import javafx.scene.control.ComboBox;
import javafx.scene.control.Label;

public class ControladorVentana2 {
	
	@FXML private Button btSaluda;
	
	@FXML private ComboBox&lt;String&gt; cbAcciones;
	
	private Label lbMensajes;
	
	public void setLBMensajes(Label lbMensajes) {
		this.lbMensajes = lbMensajes;
	}
	
	@FXML 
	private void initialize() {
		cbAcciones.setItems(FXCollections.observableArrayList("Accion 1 Ventana 2", "Accion 2 Ventana 2"));
	}
	
	@FXML
	private void saluda() {
		lbMensajes.setText("Hola desde la ventana 2");
	}
	
	@FXML
	private void muestraEleccion() {
		lbMensajes.setText("Has elegido " + cbAcciones.getSelectionModel().getSelectedItem());
	}
}</code></pre>
</div>
</div>
<p></p></div>
</div>
</div>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="scenebuilder.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="cdigo_de_los_ejemplos.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
<div id="siteFooter"><p style="text-align: center; font-size: large;">CC by-nc - <strong>José Ramón Jiménez Reyes </strong>- IES Al-Ándalus</p></div></div>
<script type="text/javascript" src="_fpd_js.js"></script></body></html>